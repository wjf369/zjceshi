#!usr/bin/python
# -*- coding: utf-8 -*-
import mysql.connector
import datetime
mydb = mysql.connector.connect(
    host="39.98.169.249",  # 数据库主机地址
    user="dev_wujinfa",  # 数据库用户名
    passwd="wjfuiop",  # 数据库密码
    database="yourbay_test"
)

# mydb = mysql.connector.connect(
#     host="rm-8vb6yntx7c0i3b51kbo.mysql.zhangbei.rds.aliyuncs.com",  # 数据库主机地址
#     user="dev_wujinfa",  # 数据库用户名
#     passwd="wjfuiop",  # 数据库密码
#     database="yourbay"
# )

mycursor = mydb.cursor()

# mycursor.execute(
#     "SELECT to_url,distributor_id,qr_code from yourbay_tst.yb_tst_brain_activation_code WHERE qr_code = %d" % (bian3))
# rows1 = mycursor.fetchall()  1718226 1723332 1723476 1723464

# mycursor.execute("INSERT INTO tp_nbv_auth_u2jg_access(uid, jgid,group_id,createdby,flag,examine_flag) VALUES (1723332, 1607,20818,161458,1,2)")
# rows1 = mycursor.fetchall()
# mycursor.execute("INSERT INTO tp_nbv_auth_u2jg_access(uid, jgid,group_id,createdby,flag,examine_flag) VALUES (1723332, 1607,20818,161458,1,2)")
# mydb.commit()



# list =[37911,37912,37935,38584,38623,45181,45230,45940,46423,46426,46427,46430,46439,46442,46455,46457,46630,47090,47199,47210,47218,47220,47222,47344,47762,47769,47947,48957,48959,51850,53458,53865,54140,54796,55159,61299,61464,62413,62972,62983,64076,64078,64081,65119,65345,65586,65766,65787,65810,66924,67422,70263,74384,90378,99970,106849,108535,109693,111742,118344,119343,123401,124059,125349,130326,130876,133227,139274,140218,143293,144592,148098,148414,149820,151498,154591,154819,155614,157639,160934,164877,171328,197702,201442,202501,202509,205151,209631,210392,213506,213817,214640,214785,216162,218157,219822,220379,221142,221962,223071,224679,224752,225658,228316,228610,235043,237062,244294,244931,248088,252823,255140,255211,255420,263192,265217,265724,266050,266894,267076,267654,268590,269841,269897,271491,281951,282390,286368,286626,290680,290843,293289,294288,299143,301361,302668,302907,302912,309788,311339,313769,316634,317402,318306,322779,322840,323194,324540,326479,330504,330718,332994,336080,340236,344162,347550,348410,350334,351369,369086,370835,375108,375889,387150,389633,392583,400458,406671,407439,412506,413786,416074,418241,420044,421637,424374,424994,428185,428966,429884,432366,441129,449973,450528,453957,455080,468474,475354,491108,491189,508990,509874,516689,519971,520261,520372,521324,525884,528190,539988,548264,551056,557903,558085,559614,561438,561484,563805,567301,567766,572477,576448,577230,580212,580425,581236,584626,589457,595173,600822,604186,604304,605012,605117,605843,607817,610100,610693,615291,617479,618867,622580,623108,625797,626350,628287,628290,629787,631431,642229,644934,645298,646077,651223,657345,660356,668055,668103,672339,672420,673437,674607,679073,692716,695843,705728,716000,722950,724176,724969,730640,730789,730968,732422,739723,740524,743017,744692,779743,783969,784344,788910,795148,798067,799034,803128,811580,824137,832043,840977,857276,861062,870722,875378,875743,878986,884404,899180,902506,910896,922394,930193,932662,932989,937644,938046,940751,940772,941135,946313,947669,949439,950952,952793,953844,955133,961839,962430,970500,970808,978007,979353,989816,990070,992695,997950,1006377,1013743,1019195,1024486,1028071,1032488,1034758,1036285,1041473,1044958,1056482,1059112,1065303,1065326,1069828,1072107,1084690,1106147,1109817,1124711,1125357,1135425,1138369,1138969,1145514,1150515,1158086,1160590,1166086,1169686,1170990,1172593,1184401,1187568,1194504,1208446,1210806,1210973,1211026,1211136,1215224,1218510,1218776,1234525,1235426,1240077,1240527,1241434,1243436,1245055,1245392,1255466,1257003,1263564,1268052,1270846,1281141,1281350,1281571,1284219,1294496,1314606,1322517,1324461,1325189,1327372,1327377,1327911,1336945,1349080,1362161,1362989,1371206,1373168,1373675,1380774,1384164,1388773,1390486,1396023,1402513,1403835,1406359,1406797,1411826,1412875,1424226,1427568,1430712,1436055,1450876,1455142,1460593,1464948,1465243,1469714,1477471,1481813,1482579,1498405,1504623,1521182,1521985,1527276,1531841,1532692,1533913,1570397,1586200,1594659,1595424,1601683,1610421,1621970,1623395,1634621,1639151,1642054,1657774,1660892,1662657,1664774,1664919,1675296,1704520,1705797,1706013,1711148,1722398,1731106,1733413,1734033,1737637,1737710,1747887,1765683,1767461,1767926,1770001,1779305,1794099,1819243,1830056,1856611,1868915,1874435,1882265,1883833,1891063,1898071,1913832,1920410,1930081,1949509,1956013,1959276,1983461,2001913,2006885,2014553,2017373,2027150,2032326,2052883,2053676,2064921,2066123,2066295,2072943,2089796,2099046,2099205,2116251,2151200,2166437,2167311,2187226,2198457,2205287,2209007,2213526,2263680,2301943,2350741,2350876,2377185,2390409,2398997,2406465,2412308,2419187,2420809,2423584,2463176,2471016,2475904,2523444,2575590,2601482,2603410,2611319,2617773,2624719,2625957,2629795,2640510,2650509,2674003,2683487,2716548,2719904,2727455,2730844,2739275,2756323,2766316,2774646,2776421,2790186,2791998,2802431,2811817,2814268,2845221,2859111,2876797,2879772,2887713,2890265,2945681,2946927,2994425,2998360,2999588,3005936,3031605,3140977,3151538,3170149,3183458,3191365,3191376,3214301,3229690,3233110,3234573,3250053,3331939,3338412,3340726,3394820,3400183,3415332,3424628,3425932,3444854,3455073,3520666,3545699,3561078,3564779,3574489,3574802,3721498,3750883,3774481,3776896,3790700,3796678,3821817,3849565,3860540,3863886,3916320,3930729,3962248,3972661,3998346,4003724,4007685,4008306,4015676,4021070,4131243,4134177,4168321]
list =[68293]
for row1 in list:
    mycursor.execute(
        "SELECT endtime from tp_yb_borrowercard WHERE id =%d" % (row1))
    rows2 = mycursor.fetchall()
    # print(rows2)
    for i in rows2:
        print(i[0])
    # print (rows2(0).strftime('%Y-%m-%d %H:%M:%S'))
    # print(rows2 - 5)
    #     mycursor.execute(
    #         "SELECT endtime from tp_yb_borrowercard WHERE endtime =%s" % (i[0]))
    #     rows3 = mycursor.fetchall()
    #     print(rows3)
        delta = datetime.timedelta(days=5)
        ii = i[0]+delta
        # print(ii)
        # mycursor.execute(
        #     "INSERT INTO tp_yb_borrowercard(endtime) VALUES (%s )" % (ii))
        try:
            mycursor.execute("UPDATE tp_yb_borrowercard  SET endtime = '%s'  WHERE id =%d" % (ii, row1))
            # mycursor.execute("UPDATE yourbay_tst.yb_tst_brain_activation_code  SET "
                             # "to_url = 'https://h5.yourbay.net/cmsh5/#/assessDirectorHome?jgid=%d',distributor_id=%d,status =2 WHERE type=2 AND qr_code =%d" % (can1,can1,bian3))

            mydb.commit()

        except Exception as e:
            # 访问异常的错误编号和详细信息
            print("错误")
            mydb.rollback()



    # print(rows3)
